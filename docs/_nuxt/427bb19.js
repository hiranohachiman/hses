(window.webpackJsonp=window.webpackJsonp||[]).push([[6,3],{285:function(e,t,r){"use strict";r.r(t);r(200);var n={name:"BuefyCard",components:{VueEllipseProgress:r(143).VueEllipseProgress},props:{progress:{type:Number,required:!0},count:{type:Number,required:!0}},created:function(){},data:function(){return{gradient:{radial:!1,colors:[{color:"#6546f7",offset:"0",opacity:"1"},{color:"lime",offset:"100",opacity:"0.6"}]}}}},o=r(49),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"mx-auto items-center"},[t("div",{staticClass:"max-w-xl mx-auto text-center"},[t("p",{staticClass:"text-2xl mt-5 mb-5"},[e._v(" Cited by ")]),e._v(" "),t("vue-ellipse-progress",{attrs:{data:e.circles,progress:e.progress,angle:-90,color:e.gradient,size:200,lineMode:"normal",legend:!0,legendClass:"legend-custom-style",animation:"reverse 700 400",noData:!1,loading:!1,fontColor:"#000",half:!1,gap:10,reverse:"",colorFill:e.colorFillGradient,legendValue:100,thickness:10}},[t("p",{staticClass:"text-4xl"},[e._v(e._s(e.count))])])],1)])}),[],!1,null,null,null);t.default=component.exports},333:function(e,t,r){"use strict";r.r(t);r(289);var n=r(10),o=(r(50),r(89),r(32),r(51),r(52),r(303),r(53),r(54),r(42),r(43),r(21),r(25),r(44),r(33),r(34),r(35),r(285));function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,a){if(e){if("string"==typeof e)return c(e,a);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,a):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,l=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw l}}}}function c(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,r=Array(a);t<a;t++)r[t]=e[t];return r}var d=r(305),m={name:"IndexPage",components:{Card:o.default},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,l,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("=== ページが読み込まれました ==="),console.log("Vue.js が動作しています"),r=e.$route.params.page,n=e.$route.query.username,console.log("ルートパラメータ:",{page:r,username:n}),!(r<=0||r>20)){t.next=8;break}return e.$buefy.toast.open({message:"不正なURLです",type:"is-danger"}),t.abrupt("return");case 8:if(o=e.getCookie("current"),console.log("saved:",o),!o){t.next=14;break}e.items=o,t.next=26;break;case 14:return e.isLoading=!0,t.next=17,e.callApi("fetchid?username="+n);case 17:return l=t.sent,c=parseInt(l)+10*(parseInt(r)-1),console.log("index",c),t.next=22,e.callApi("fetch?index="+c);case 22:d=t.sent,console.log("items",d),d&&0!==d.length?e.items=d:(console.log("APIからデータが取得できませんでした。テスト用ダミーデータを使用します。"),e.items=[{id:1,url:"https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",caption:"サンプル動画です。車が道路を走っている映像。"},{id:2,url:"https://via.placeholder.com/800x600/0066cc/ffffff?text=Sample+Image",caption:"サンプル画像です。青い背景に白いテキスト。"},{id:3,url:"https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-mp4-file.mp4",caption:"別のサンプル動画です。"}]),e.isLoading=!1;case 26:e.page=r,e.nextLink=20!=r?"/exp/"+(parseInt(r)+1)+"?username="+n:"/term",console.log(e.items),console.log("アイテム数:",e.items.length),e.items.forEach((function(t,r){console.log("アイテム".concat(r,":"),{id:t.id,url:t.url,caption:t.caption,isVideo:e.isVideo(t.url||"")})})),e.startTime=new Date;case 32:case"end":return t.stop()}}),t)})))()},mounted:function(){console.log("=== DOM が完全に読み込まれました ==="),console.log("アイテム数 (mounted):",this.items.length),console.log("現在のitems:",this.items),this.items.length>0&&(this.radio=Array(this.items.length).fill("-1"),this.mediaErrors=Array(this.items.length).fill(!1),console.log("radio配列を調整しました:",this.radio.length));var e=document.querySelectorAll("video"),t=document.querySelectorAll("img");console.log("DOM内の動画要素数:",e.length),console.log("DOM内の画像要素数:",t.length)},methods:{execute:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.fullFill()){t.next=3;break}return e.$buefy.toast.open({message:"全ての項目に回答してください",type:"is-danger"}),t.abrupt("return");case 3:return e.isLoading=!0,t.next=6,e.sendResults();case 6:e.eraseCookie("current"),e.isLoading=!1,e.$router.push(e.nextLink);case 9:case"end":return t.stop()}}),t)})))()},fullFill:function(){for(var i=0;i<this.radio.length;i++)if("-1"==this.radio[i])return!1;return!0},sendResults:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,time,n,body,i,o,l,c,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=new Date,time=(r-e.startTime)/1e3,console.log("time",time),e.$buefy.toast.open({message:"結果を送信しています",type:"is-success"}),n=e.$route.query.username,body=[],i=0;i<e.items.length;i++)o={username:n,caption_id:e.items[i].id,type:"M3",mos:parseInt(e.radio[i]),time:time},body.push(o);return l=e.getApiUrl("aggregate"),t.next=10,d.post(l,body);case 10:c=t.sent,m=JSON.parse(JSON.stringify(c.data)),console.log("aggregate:",m);case 13:case"end":return t.stop()}}),t)})))()},getApiUrl:function(e){return"https://patrick-back-f238203eb2a4.herokuapp.com/"+e},callApi:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=t.getApiUrl(e),console.log("API呼び出し:",n),r.next=5,fetch(n);case 5:if((o=r.sent).ok){r.next=8;break}throw new Error("HTTP error! status: ".concat(o.status));case 8:return r.next=10,o.json();case 10:return l=r.sent,console.log("API応答:",l),t.saveCookie("current",l),r.abrupt("return",l);case 16:return r.prev=16,r.t0=r.catch(0),console.error("API呼び出しエラー:",r.t0),t.$buefy.toast.open({message:"データの取得に失敗しました: "+r.t0.message,type:"is-danger"}),r.abrupt("return",[]);case 21:case"end":return r.stop()}}),r,null,[[0,16]])})))()},getCookie:function(e){var t,r=l(document.cookie.split(";"));try{for(r.s();!(t=r.n()).done;){var n=t.value.split("="),o=n[0],c=n[1];if(console.log("cookie",'"'+o+'"','"'+e+'"'),o==e)return JSON.parse(decodeURIComponent(c))}}catch(e){r.e(e)}finally{r.f()}},saveCookie:function(e,t){document.cookie=e+"="+encodeURIComponent(JSON.stringify(t))},eraseCookie:function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC;"},isVideo:function(e){if(!e)return console.log("URL is empty or null"),!1;var t=/\.(mp4|webm|ogg|avi|mov|wmv|flv|mkv|m4v)$/i.test(e.trim());return console.log("URL: ".concat(e,", isVideo: ").concat(t)),t},onVideoError:function(e,t){console.error("動画の読み込みエラー:",e),this.mediaErrors[t]=!0},onImageError:function(e,t){console.error("画像の読み込みエラー:",e),this.mediaErrors[t]=!0},onMediaLoadStart:function(e){console.log("メディアの読み込み開始: ".concat(e))},onMediaLoaded:function(e){console.log("メディアの読み込み完了: ".concat(e))}},data:function(){return{isLoading:!1,mainDescription:"文章がどれほど画像の特徴を捉えているかを5段階で評価してください。",instruction:null,radio:Array(10).fill("-1"),items:[],page:-1,nextLink:"exp/2",startTime:null,mediaErrors:Array(10).fill(!1)}}},f=r(49),component=Object(f.a)(m,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"bg-gray-50"},[t("div",{staticClass:"px-4 pt-16 mx-auto max-w-screen-xl lg:h-4/6 lg:items-center lg:flex"},[t("div",{staticClass:"max-w-xl mx-auto"},[t("p",{staticClass:"text-center font-bold"}),e._v(" "),t("p",{staticClass:"text-center text-2xl font-bold"},[e._v(e._s(e.mainDescription))]),e._v(" "),e._m(0),e._v(" "),t("div",{staticClass:"mt-10 mb-5 text-center"},[t("b-loading",{attrs:{"is-full-page":!1,"can-cancel":!1},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}}),e._v(" "),e._l(e.items,(function(r,n){return t("div",{staticClass:"flex-col mt-5 p-5 border border-gray-200 rounded-2xl shadow-2xl"},[t("div",[t("span",{staticStyle:{color:"red"}},[e._v("item.url: "+e._s(r.url))]),e._v(" "),r.url?t("div",[e.isVideo(r.url)?t("video",{staticClass:"mx-auto",staticStyle:{"max-height":"80vh"},attrs:{src:r.url.trim(),controls:""},on:{error:function(t){return e.onVideoError(r.url,n)},loadstart:function(t){return e.onMediaLoadStart(n)},loadeddata:function(t){return e.onMediaLoaded(n)}}},[e._v("\n                お使いのブラウザは動画タグをサポートしていません。\n              ")]):t("img",{staticClass:"mx-auto",staticStyle:{"max-height":"80vh",border:"2px solid blue"},attrs:{src:r.url.trim(),alt:"評価対象の画像"},on:{error:function(t){return e.onImageError(r.url,n)},load:function(t){return e.onMediaLoaded(n)}}}),e._v(" "),e.mediaErrors[n]?t("div",{staticClass:"text-center text-red-500 mt-4"},[t("p",[e._v("メディアの読み込みに失敗しました")]),e._v(" "),t("p",{staticClass:"text-sm"},[e._v("URL: "+e._s(r.url))])]):e._e()]):t("div",{staticClass:"text-center text-gray-500 mt-4"},[t("p",[e._v("URLが設定されていません")])])]),e._v(" "),t("div",{staticClass:"mx-auto mt-4 font-bold"},[e._v("\n            "+e._s(r.caption)+"\n          ")]),e._v(" "),t("div",{staticClass:"mx-auto mt-4 block"},[t("b-radio",{attrs:{"native-value":"5",type:"is-info"},model:{value:e.radio[n],callback:function(t){e.$set(e.radio,n,t)},expression:"radio[index]"}},[e._v("\n              とても良い\n            ")]),e._v(" "),t("b-radio",{attrs:{"native-value":"4",type:"is-info"},model:{value:e.radio[n],callback:function(t){e.$set(e.radio,n,t)},expression:"radio[index]"}},[e._v("\n              良い\n            ")]),e._v(" "),t("b-radio",{attrs:{"native-value":"3",type:"is-info"},model:{value:e.radio[n],callback:function(t){e.$set(e.radio,n,t)},expression:"radio[index]"}},[e._v("\n              普通\n            ")]),e._v(" "),t("b-radio",{attrs:{"native-value":"2",type:"is-info"},model:{value:e.radio[n],callback:function(t){e.$set(e.radio,n,t)},expression:"radio[index]"}},[e._v("\n              悪い\n            ")]),e._v(" "),t("b-radio",{attrs:{"native-value":"1",type:"is-info"},model:{value:e.radio[n],callback:function(t){e.$set(e.radio,n,t)},expression:"radio[index]"}},[e._v("\n              とても悪い\n            ")])],1),e._v(" "),null!=e.instruction?t("p",{staticClass:"my-auto"},[e._v("\n            "+e._s(e.instruction)+"\n          ")]):e._e()])}))],2),e._v(" "),t("div",{staticClass:"text-center"},[t("b-button",{attrs:{type:"is-primary"},on:{click:e.execute}},[e._v("次へ")]),e._v(" "),t("p",[e._v("("+e._s(e.page)+" / 20)")])],1)])])])}),[function(){var e=this,t=e._self._c;return t("ul",{staticClass:"mt-5"},[t("li",[e._v("・基本的に加点/減点方式で評価してください！")]),e._v(" "),t("li",[e._v("・無関係な単語が現れても, 的確な物体が一度でも現れていれば加点してください。")]),e._v(" "),t("li",[e._v("・無関係な単語は減点です。")]),e._v(" "),t("li",[e._v("・詳細で的確であれば「とても良い」と評価してください。")])])}],!1,null,null,null);t.default=component.exports}}]);